<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Valida√ß√£o de Email</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste de Valida√ß√£o de Email</h1>
        <p>Este teste verifica se o email 'testetotal@teste.com' √© v√°lido segundo o schema de valida√ß√£o.</p>
        
        <div class="test-section">
            <h3>Teste Manual</h3>
            <input type="email" id="testEmail" placeholder="Digite o email para testar" value="testetotal@teste.com">
            <button onclick="testEmailValidation()">Testar Email</button>
            <div id="manualResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>Testes Autom√°ticos</h3>
            <button onclick="runAllTests()">Executar Todos os Testes</button>
            <div id="autoResults"></div>
        </div>

        <div class="test-section">
            <h3>Log de Debug</h3>
            <button onclick="clearLog()">Limpar Log</button>
            <div id="debugLog" class="log"></div>
        </div>
    </div>

    <script>
        // Recriar o schema de valida√ß√£o Zod aqui
        function validateEmail(email) {
            const log = [];
            
            // 1. Verificar se n√£o est√° vazio
            if (!email || email.length === 0) {
                log.push('‚ùå Email √© obrigat√≥rio');
                return { valid: false, errors: ['Email √© obrigat√≥rio'], log };
            }
            log.push('‚úÖ Email n√£o est√° vazio');
            
            // 2. Verificar formato b√°sico de email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                log.push('‚ùå Formato de email inv√°lido');
                return { valid: false, errors: ['Formato de email inv√°lido'], log };
            }
            log.push('‚úÖ Formato b√°sico de email v√°lido');
            
            // 3. Verificar se n√£o tem espa√ßos
            if (email.includes(' ')) {
                log.push('‚ùå Email n√£o pode conter espa√ßos');
                return { valid: false, errors: ['Email n√£o pode conter espa√ßos'], log };
            }
            log.push('‚úÖ Email n√£o cont√©m espa√ßos');
            
            // 4. Verificar dom√≠nio b√°sico
            const parts = email.split('@');
            if (parts.length !== 2) {
                log.push('‚ùå Email deve ter exatamente um @');
                return { valid: false, errors: ['Email deve ter exatamente um @'], log };
            }
            
            const domain = parts[1];
            if (!domain || !domain.includes('.')) {
                log.push('‚ùå Dom√≠nio de email inv√°lido (deve conter pelo menos um ponto)');
                return { valid: false, errors: ['Dom√≠nio de email inv√°lido'], log };
            }
            log.push('‚úÖ Dom√≠nio cont√©m ponto');
            
            // 5. Verificar se o dom√≠nio tem pelo menos uma parte ap√≥s o ponto
            const domainParts = domain.split('.');
            const lastPart = domainParts[domainParts.length - 1];
            if (!lastPart || lastPart.length === 0) {
                log.push('‚ùå Dom√≠nio deve ter extens√£o v√°lida');
                return { valid: false, errors: ['Dom√≠nio deve ter extens√£o v√°lida'], log };
            }
            log.push('‚úÖ Dom√≠nio tem extens√£o');
            
            // 6. Verificar tamanho m√°ximo
            if (email.length > 254) {
                log.push('‚ùå Email demasiado longo (m√°ximo 254 caracteres)');
                return { valid: false, errors: ['Email demasiado longo'], log };
            }
            log.push('‚úÖ Email n√£o √© demasiado longo');
            
            log.push('üéâ Email v√°lido!');
            return { valid: true, errors: [], log };
        }
        
        function testEmailValidation() {
            const email = document.getElementById('testEmail').value;
            const result = validateEmail(email);
            const resultDiv = document.getElementById('manualResult');
            
            if (result.valid) {
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `‚úÖ Email "${email}" √© V√ÅLIDO`;
            } else {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `‚ùå Email "${email}" √© INV√ÅLIDO<br>Erros: ${result.errors.join(', ')}`;
            }
            
            // Adicionar ao log
            addToLog(`\nüß™ Teste manual para: "${email}"`);
            result.log.forEach(logEntry => addToLog(logEntry));
        }
        
        function runAllTests() {
            const testCases = [
                { email: 'testetotal@teste.com', expected: false, description: 'Email da imagem (testetotal@teste.com)' },
                { email: 'teste@teste', expected: false, description: 'Email sem extens√£o' },
                { email: 'teste@teste.', expected: false, description: 'Email com ponto final mas sem extens√£o' },
                { email: 'teste@teste.com', expected: true, description: 'Email v√°lido b√°sico' },
                { email: 'user@example.org', expected: true, description: 'Email v√°lido com .org' },
                { email: 'test@domain', expected: false, description: 'Email sem TLD' },
                { email: 'test @example.com', expected: false, description: 'Email com espa√ßos' },
                { email: '', expected: false, description: 'Email vazio' },
                { email: 'invalid-email-format', expected: false, description: 'Email sem @ e dom√≠nio' }
            ];
            
            const resultsDiv = document.getElementById('autoResults');
            resultsDiv.innerHTML = '';
            
            addToLog('\nüöÄ Executando testes autom√°ticos...');
            
            testCases.forEach(({ email, expected, description }) => {
                const result = validateEmail(email);
                const testPassed = result.valid === expected;
                
                const testResult = document.createElement('div');
                testResult.className = `result ${testPassed ? 'success' : 'error'}`;
                
                if (testPassed) {
                    testResult.innerHTML = `‚úÖ ${description}: PASSOU`;
                    addToLog(`‚úÖ ${description}: PASSOU`);
                } else {
                    testResult.innerHTML = `‚ùå ${description}: FALHOU<br>Email: "${email}"<br>Esperado: ${expected ? 'v√°lido' : 'inv√°lido'}, Obtido: ${result.valid ? 'v√°lido' : 'inv√°lido'}<br>Erros: ${result.errors.join(', ')}`;
                    addToLog(`‚ùå ${description}: FALHOU`);
                    addToLog(`   Email: "${email}"`);
                    addToLog(`   Esperado: ${expected ? 'v√°lido' : 'inv√°lido'}, Obtido: ${result.valid ? 'v√°lido' : 'inv√°lido'}`);
                    addToLog(`   Erros: ${result.errors.join(', ')}`);
                }
                
                resultsDiv.appendChild(testResult);
            });
        }
        
        function addToLog(message) {
            const logDiv = document.getElementById('debugLog');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('debugLog').textContent = '';
        }
        
        // Executar teste inicial
        window.onload = function() {
            addToLog('üîß Sistema de teste de valida√ß√£o de email carregado');
            addToLog('üìß Email a testar: testetotal@teste.com');
            testEmailValidation();
        };
    </script>
</body>
</html>